----------------------------------------------------------------------------------------------------------------------------------------
--建立檢視表
----------------------------------------------------------------------------------------------------------------------------------------
use ClassNorthwind
Go
----------------------------------------------------------------------------------------------------------------------------------------
--前後需用Go做分隔
----------------------------------------------------------------------------------------------------------------------------------------
alter View FormaggiProductsView
--with Encryption 加密檢視表
as --as 後加資料表內容                                                                                                                                    
select ProductID, ProductName, SupplierID, CategoryID, QuantityPerUnit, UnitPrice, Discontinued 
from Products
WHERE SupplierID = 14
----------------------------------------------------------------------------------------------------------------------------------------
with check option --增修須符合檢視表條件
----------------------------------------------------------------------------------------------------------------------------------------
Go

select * from FormaggiProductsView

update FormaggiProductsView
set SupplierID = 15
where ProductID = 31
----------------------------------------------------------------------------------------------------------------------------------------
--使用View做資料的分割
----------------------------------------------------------------------------------------------------------------------------------------
use ClassNorthwind
Go
Create view CombineCS
as
select [CompanyName],[ContactName],[City],[PostalCode],'Customers' as DataSource
from Customers
union
select [CompanyName],[ContactName],[City],[PostalCode],'Suppliers'
from Suppliers --[192.168.34.116].ClassNorthwind.dbo.Suppliers
Go

select * from CombineCS
----------------------------------------------------------------------------------------------------------------------------------------